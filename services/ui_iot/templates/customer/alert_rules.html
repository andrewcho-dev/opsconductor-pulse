{% extends "customer/base.html" %}
{% block title %}Alert Rules{% endblock %}
{% block content %}
  <div class="card">
    <div class="header-row">
      <h2>Alert Rules</h2>
      <button id="btn-add-rule">Add Rule</button>
    </div>
    <div id="rules-list" class="list-body">
      <div>Loading...</div>
    </div>
  </div>

  <!-- Modal for create/edit -->
  <div id="rule-modal" class="hidden modal-overlay">
    <div class="card modal">
      <h3 id="modal-title">Add Alert Rule</h3>
      <form id="rule-form">
        <input type="hidden" id="rule-id" value="">

        <div class="form-row">
          <label for="rule-name">Rule Name</label>
          <input type="text" id="rule-name" required maxlength="100" placeholder="e.g., Low Battery Warning">
        </div>

        <div class="form-row">
          <label for="rule-metric">Metric Name</label>
          <input type="text" id="rule-metric" required maxlength="100" placeholder="e.g., battery_pct, temp_c, pressure_psi">
        </div>

        <div class="form-row">
          <label for="rule-operator">Operator</label>
          <select id="rule-operator" required>
            <option value="LT">&lt; Less than</option>
            <option value="LTE">&le; Less than or equal</option>
            <option value="GT">&gt; Greater than</option>
            <option value="GTE">&ge; Greater than or equal</option>
          </select>
        </div>

        <div class="form-row">
          <label for="rule-threshold">Threshold</label>
          <input type="number" id="rule-threshold" required step="any" placeholder="e.g., 20.0">
        </div>

        <div class="form-row">
          <label for="rule-severity">Severity</label>
          <select id="rule-severity">
            <option value="5">5 - Critical</option>
            <option value="3" selected>3 - Warning</option>
            <option value="1">1 - Info</option>
          </select>
        </div>

        <div class="form-row">
          <label for="rule-description">Description (optional)</label>
          <input type="text" id="rule-description" maxlength="255" placeholder="Optional description">
        </div>

        <div class="form-row">
          <label for="rule-enabled">
            <input type="checkbox" id="rule-enabled" checked> Enabled
          </label>
        </div>

        <div id="form-error" class="hidden form-error"></div>
        <div class="form-actions">
          <button type="button" id="btn-cancel">Cancel</button>
          <button type="submit">Save</button>
        </div>
      </form>
    </div>
  </div>
{% endblock %}
{% block head %}
<script src="/static/js/alert_rules.js" defer></script>
{% endblock %}
