{% extends "customer/base.html" %}

{% block title %}Email Integrations{% endblock %}

{% block content %}
<div class="card">
    <div class="header-row">
        <h2>Email Integrations</h2>
        <button id="btn-add-email">Add Email Integration</button>
    </div>
    <div id="email-list" class="list-body">
        <div>Loading...</div>
    </div>
</div>

<div id="email-modal" class="hidden modal-overlay">
    <div class="card modal">
        <h3 id="modal-title">Add Email Integration</h3>
        <form id="email-form">
            <input type="hidden" id="integration-id" value="">

            <div class="form-row">
                <label>Name</label>
                <input type="text" id="email-name" required placeholder="Alert Emails">
            </div>

            <div class="form-section">
                <h4>SMTP Settings</h4>
                <div class="form-row">
                    <label>SMTP Host</label>
                    <input type="text" id="smtp-host" required placeholder="smtp.example.com">
                </div>
                <div class="form-row">
                    <label>Port</label>
                    <input type="number" id="smtp-port" value="587">
                </div>
                <div class="form-row">
                    <label>Username (optional)</label>
                    <input type="text" id="smtp-user">
                </div>
                <div class="form-row">
                    <label>Password (optional)</label>
                    <input type="password" id="smtp-password">
                </div>
                <div class="form-row">
                    <label>
                        <input type="checkbox" id="smtp-tls" checked>
                        Use TLS (STARTTLS)
                    </label>
                </div>
            </div>

            <div class="form-section">
                <h4>From Address</h4>
                <div class="form-row">
                    <label>Email</label>
                    <input type="email" id="from-address" required placeholder="alerts@example.com">
                </div>
                <div class="form-row">
                    <label>Name (optional)</label>
                    <input type="text" id="from-name" placeholder="OpsConductor Alerts">
                </div>
            </div>

            <div class="form-section">
                <h4>Recipients</h4>
                <div class="form-row">
                    <label>To (comma-separated)</label>
                    <input type="text" id="recipients-to" required placeholder="admin@example.com, oncall@example.com">
                </div>
                <div class="form-row">
                    <label>CC (optional)</label>
                    <input type="text" id="recipients-cc">
                </div>
                <div class="form-row">
                    <label>BCC (optional)</label>
                    <input type="text" id="recipients-bcc">
                </div>
            </div>

            <div class="form-section">
                <h4>Email Template</h4>
                <div class="form-row">
                    <label>Subject Template</label>
                    <input type="text" id="subject-template" placeholder="[{severity}] {alert_type}: {device_id}">
                    <div class="small">Variables: {severity}, {alert_type}, {device_id}, {message}</div>
                </div>
                <div class="form-row">
                    <label>Format</label>
                    <select id="email-format">
                        <option value="html">HTML</option>
                        <option value="text">Plain Text</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <label>
                    <input type="checkbox" id="email-enabled" checked>
                    Enabled
                </label>
            </div>

            <div id="form-error" class="hidden form-error"></div>

            <div class="form-actions">
                <button type="button" id="btn-cancel">Cancel</button>
                <button type="submit">Save</button>
            </div>
        </form>
    </div>
</div>

<script src="/static/js/email_integrations.js"></script>
{% endblock %}
